<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
                template="/WEB-INF/templates/main.xhtml">
    <ui:define name="css">
        <link rel="stylesheet" type="text/css" href="/resources/css/login.css"/>
    </ui:define>

    <ui:define name="content">
        <div class="container pt-5 reduced-mobile-spacing">
            <div class="row py-3">
                <div class="col-lg">
                    <h1 class="display-4 text-center">Create a new QuestionSet</h1>
                </div>
            </div>
        </div>

        <div class="container-fluid mt-5 reduced-mobile-margin" id="responsive-formgroup">
            <h:form id="questionSetForm" rendered="#{questionSetBean.questionSet.name == null}">

                <div class="form-group">
                    <label for="setName">Set name</label>
                    <h:inputText type="text" styleClass="form-control" value="#{questionSetBean.questionSet.name}"
                                 name="setName" id="setName" pt:placeholder="Music theory" pt:autocomplete="off"
                                 pt:required="true"/>
                </div>

                <div class="form-group">
                    <label for="setDesc">Description</label>
                    <h:inputText type="text" styleClass="form-control"
                                 value="#{questionSetBean.questionSet.description}"
                                 name="setDesc" id="setDesc" pt:placeholder="Easy questions based on semester 1"
                                 pt:autocomplete="off"/>
                </div>

                <div class="container-fluid mx-0 px-0 my-5">
                    <div class="row">
                        <ui:repeat id="items" value="#{questionSetBean.difficulty}" var="diff">


                            <div class="form-check form-check-inline w-50 mx-0 px-0 justify-content-center">
                                <input type="radio" class="form-check-input" jsf:id="difficulty"
                                       pt:name="#{hiddenIt.clientId}"
                                       value="#{diff}"
                                       pt:checked="#{diff eq questionSetBean.questionSet.difficulty ? 'checked' : null}"/>
                                <h:outputLabel styleClass="form-check-label"
                                               value="#{capitalizeConverter.capitalize(diff)}"/>
                            </div>

                        </ui:repeat>

                        <h:inputHidden id="selectedDiff" binding="#{hiddenIt}"
                                       value="#{questionSetBean.questionSet.difficulty}"
                                       rendered="#{facesContext.currentPhaseId.ordinal ne 6}"/>
                    </div>
                </div>

                <div class="row py-5 pb-md-5">
                    <div class="col text-center">
                        <h:commandButton styleClass="btn btn-block btn-primary btn-lg" id="saveQuestion"
                                         action="#{questionSetBean.saveNewQuestionSet}" value="Step 2: Add questions"/>
                    </div>
                </div>

            </h:form>

            <h:form id="questionForm" rendered="#{questionSetBean.questionSet.name != null}">
                <div class="form-group">
                    <label for="question">Question</label>
                    <h:inputText type="text" styleClass="form-control"
                                 value="#{questionSetBean.question.questionString}"
                                 name="question" id="question" pt:autocomplete="off" pt:required="true"/>
                    <h:message for="question" styleClass="state-error"/>
                </div>

                <div class="form-group">
                    <label for="corrAnswer">Correct answer</label>
                    <h:inputText type="text" styleClass="form-control"
                                 value="#{questionSetBean.question.rightAnswerString}"
                                 name="corrAnswer" id="corrAnswer" pt:autocomplete="off" pt:required="true"/>
                </div>

                <div class="form-group">
                    <label for="wrongAnswer1">Wrong answer #1</label>
                    <h:inputText type="text" styleClass="form-control"
                                 value="#{questionSetBean.question.wrongAnswerString_1}" name="wrongAnswer1"
                                 pt:required="true" id="wrongAnswer1" pt:autocomplete="off"/>
                </div>

                <div class="form-group">
                    <label for="wrongAnswer2">Wrong answer #2</label>
                    <h:inputText type="text" styleClass="form-control"
                                 value="#{questionSetBean.question.wrongAnswerString_2}" name="wrongAnswer2"
                                 id="wrongAnswer2" pt:autocomplete="off"/>
                </div>

                <div class="form-group">
                    <label for="wrongAnswer3">Wrong answer #3</label>
                    <h:inputText type="text" styleClass="form-control"
                                 value="#{questionSetBean.question.wrongAnswerString_3}" name="wrongAnswer3"
                                 id="wrongAnswer3" pt:autocomplete="off"/>
                </div>


                <div class="container-fluid mx-0 px-0 my-5">
                    <div class="row">
                        <ui:repeat id="items" value="#{questionSetBean.types}" var="item">


                            <div class="form-check form-check-inline w-50 mx-0 px-0 justify-content-center">
                                <input type="radio" class="form-check-input" jsf:id="item"
                                       pt:name="#{hiddenItem.clientId}"
                                       value="#{item}"
                                       pt:checked="#{item eq questionSetBean.question.type ? 'checked' : null}"/>
                                <h:outputLabel styleClass="form-check-label"
                                               value="#{capitalizeConverter.capitalize(item)}"/>
                            </div>

                        </ui:repeat>

                        <h:inputHidden id="selectedItem" binding="#{hiddenItem}"
                                       value="#{questionSetBean.question.type}"
                                       rendered="#{facesContext.currentPhaseId.ordinal ne 6}"/>
                    </div>
                </div>


                <h:commandButton styleClass="btn btn-block btn-primary btn-lg" pt:id="submitNew"
                                 value="Save question and add another one"
                                 action="#{questionSetBean.saveNewQuestion}">
                </h:commandButton>

                <h:commandButton styleClass="btn btn-block btn-tertiary btn-lg" pt:id="submitCancel"
                                 value="Save question and return to overview"
                                 action="#{questionSetBean.exitCreateQuestionSet}">
                </h:commandButton>

                <script type="text/javascript">
                    const inputs = document.querySelectorAll("input, select, textarea");

                    inputs.forEach(input => {
                        input.addEventListener(
                            "invalid",
                            event => {
                                input.classList.add("error");
                            },
                            false
                        );
                    });
                </script>
            </h:form>
        </div>
    </ui:define>
</ui:composition>